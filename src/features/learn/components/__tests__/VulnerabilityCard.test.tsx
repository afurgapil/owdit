import React from "react";
import { render, screen } from "@testing-library/react";
import { VulnerabilityCard } from "../VulnerabilityCard";
import { AlertTriangle } from "lucide-react";

describe("VulnerabilityCard", () => {
  const mockProps = {
    icon: AlertTriangle,
    title: "Test Vulnerability",
    description: "This is a test vulnerability description",
    risks: ["Risk 1", "Risk 2", "Risk 3"],
    borderColor: "border-neon-pink",
    iconColor: "text-neon-pink",
    iconBgColor: "bg-neon-pink/20",
  };

  it("renders vulnerability card", () => {
    render(<VulnerabilityCard {...mockProps} />);

    expect(screen.getByText("Test Vulnerability")).toBeInTheDocument();
  });

  it("displays title", () => {
    render(<VulnerabilityCard {...mockProps} />);

    const title = screen.getByText("Test Vulnerability");
    expect(title.tagName).toBe("H3");
  });

  it("displays description", () => {
    render(<VulnerabilityCard {...mockProps} />);

    expect(screen.getByText("This is a test vulnerability description")).toBeInTheDocument();
  });

  it("renders all risks", () => {
    render(<VulnerabilityCard {...mockProps} />);

    expect(screen.getByText("Risk 1")).toBeInTheDocument();
    expect(screen.getByText("Risk 2")).toBeInTheDocument();
    expect(screen.getByText("Risk 3")).toBeInTheDocument();
  });

  it("applies custom colors", () => {
    const { container } = render(<VulnerabilityCard {...mockProps} />);

    const card = container.querySelector(".border-neon-pink");
    expect(card).toBeInTheDocument();
  });

  it("renders icon", () => {
    const { container } = render(<VulnerabilityCard {...mockProps} />);

    const icons = container.querySelectorAll("svg");
    expect(icons.length).toBeGreaterThan(0);
  });

  it("renders X icons for each risk", () => {
    const { container } = render(<VulnerabilityCard {...mockProps} />);

    const xIcons = container.querySelectorAll("svg");
    // Icon + X icons for each risk
    expect(xIcons.length).toBeGreaterThan(mockProps.risks.length);
  });

  it("handles empty risks array", () => {
    const propsWithNoRisks = { ...mockProps, risks: [] };
    render(<VulnerabilityCard {...propsWithNoRisks} />);

    expect(screen.getByText("Test Vulnerability")).toBeInTheDocument();
  });
});

